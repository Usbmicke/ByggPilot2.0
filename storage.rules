
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Standardregel: Allt är skyddat som standard. Endast inloggade användare
    // kan läsa och skriva sina egna filer. Detta är en bra, säker utgångspunkt.
    match /{allPaths=**} {
      allow read, write: if request.auth != null;
    }

    // Undantag för publika logotyper
    // Vi matchar specifikt mappen där vi lägger våra logotyper.
    match /public/{allPaths=**} {
      // TILLÅT LÄSNING: Vem som helst (t.ex. en webbläsare som ska visa en <img>-tagg)
      // får läsa filer från denna mapp.
      allow read: if true;

      // SKYDDA SKRIVNING: Endast inloggade användare får skriva/ändra filer här.
      // Detta förhindrar att vem som helst kan ladda upp filer till vår publika mapp.
      allow write: if request.auth != null;
    }
  }
}
